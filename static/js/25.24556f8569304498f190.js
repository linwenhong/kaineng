webpackJsonp([25],{"3J/j":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"Order",data:function(){return{user:this.$store.getters.getUser,pageType:1,tableOptions:[{key:"out_trade_no",title:"订单号"},{key:"trade_status",title:"订单状态"},{key:"device_id",title:"设备sn"},{key:"product_sum",title:"商品数量"},{key:"total_amount",title:"订单总金额"},{key:"reality_amount",title:"实际收款金额"},{key:"pay_type",title:"支付类型"},{key:"create_at",title:"下单时间"},{key:"has_settled",title:"结算状态"}],tableOptions2:[{key:"refund_amount",title:"退款金额"}],orderGoodList:[],items:[],total:0,page:1,pageSize:this.$Config.page_size,condition:{pay_type:""},order:{},isSubmit:!1}},watch:{$route:function(t,e){this.pageInit()}},methods:{getDataTables:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a={mch_id:this.user.mch_id,page_no:e,page_size:this.pageSize};for(var i in 2==this.pageType&&(a.trade_status=3),this.condition)this.condition[i]&&(a[i]=this.condition[i]);this.$Service.Order.get(a).then(function(e){e.err_code?toastr.error(e.err_msg,e.err_code):(t.items=e.list,t.total=e.total)})},pageChange:function(t){this.getDataTables(t)},details:function(t){var e=this;this.order=t,this.$Service.Order.details({page_no:1,page_size:1e4,mch_id:this.user.mch_id,out_trade_no:t.out_trade_no}).then(function(t){t.err_code?toastr.error(t.err_msg,t.err_code):e.orderGoodList=t.list})},del:function(t){var e=this;this.$Service.Order.del(t.id).then(function(t){200==t.code?(toastr.success("删除成功"),e.getDataTables()):toastr.error(t.msg)})},refund:function(t){console.log(t)},pageInit:function(){this.pageType=this.$route.query.pageType||1,this.getDataTables()}},created:function(){this.pageInit()},mounted:function(){}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper wrapper-content"},[a("div",{staticClass:"ibox float-e-margins"},[t._m(0),t._v(" "),a("div",{staticClass:"ibox-content"},[a("div",{staticClass:"search-page"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"control-label"},[t._v("结算状态")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.condition.has_settled,expression:"condition['has_settled']"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.condition,"has_settled",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),a("option",{attrs:{value:"1"}},[t._v("未结算")]),t._v(" "),a("option",{attrs:{value:"2"}},[t._v("已结算")])]),t._v(" "),a("label",{staticClass:"control-label"},[t._v("订单号")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.condition.out_trade_no,expression:"condition['out_trade_no']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.condition.out_trade_no},on:{input:function(e){e.target.composing||t.$set(t.condition,"out_trade_no",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}),t._v(" "),a("label",{staticClass:"control-label"},[t._v("设备sn")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.condition.device_id,expression:"condition['device_id']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.condition.device_id},on:{input:function(e){e.target.composing||t.$set(t.condition,"device_id",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}),t._v(" "),a("button",{staticClass:"btn btn-primary search",attrs:{type:"button"},on:{click:function(e){t.getDataTables()}}},[t._v("查询")])])]),t._v(" "),a("table",{staticClass:"table table-bordered text-center"},[a("thead",[a("tr",[t._l(t.tableOptions,function(e){return a("th",[t._v(t._s(e.title))])}),t._v(" "),2==t.pageType?t._l(t.tableOptions2,function(e){return a("th",[t._v(t._s(e.title))])}):t._e(),t._v(" "),a("th",[t._v("操作")])],2)]),t._v(" "),a("tbody",t._l(t.items,function(e,i){return a("tr",{key:e.id},[a("td",[t._v(t._s(e.out_trade_no))]),t._v(" "),a("td",[t._v(t._s(t._f("OrderStatus")(e.trade_status)))]),t._v(" "),a("td",[t._v(t._s(e.device_id))]),t._v(" "),a("td",[t._v(t._s(e.product_sum))]),t._v(" "),a("td",[t._v(t._s(e.total_amount))]),t._v(" "),a("td",[t._v(t._s(e.reality_amount))]),t._v(" "),a("td",[t._v(t._s(t._f("PayType")(e.pay_type)))]),t._v(" "),a("td",[t._v(t._s(e.create_at))]),t._v(" "),a("td",[t._v(t._s(t._f("OrderSettlementStatus")(e.has_settled)))]),t._v(" "),2==t.pageType?[a("td",[t._v(t._s(e.refund_amount))])]:t._e(),t._v(" "),a("td",[a("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button","data-toggle":"modal","data-target":"#Modal"},on:{click:function(a){t.details(e)}}},[t._v("详情")])])],2)}))]),t._v(" "),a("vue-pagination",{attrs:{"current-page":t.page,total:t.total,"page-size":t.pageSize,theme:"gray"},on:{"current-change":t.pageChange}})],1)]),t._v(" "),a("div",{staticClass:"modal inmodal fade",attrs:{id:"Modal",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-md"},[a("div",{staticClass:"modal-content"},[t._m(1),t._v(" "),a("div",{staticClass:"modal-body"},[a("table",{staticClass:"table table-bordered text-center"},[a("thead",[a("tr",[a("th",[t._v("序号")]),t._v(" "),a("th",[t._v("商品名称")]),t._v(" "),a("th",[t._v("数量")]),t._v(" "),a("th",[t._v("单价")]),t._v(" "),a("th",[t._v("出货状态")]),t._v(" "),2==t.pageType?[a("th",[t._v("退款状态")]),t._v(" "),a("th",[t._v("操作")])]:t._e()],2)]),t._v(" "),a("tbody",[t._l(t.orderGoodList,function(e,i){return a("tr",{key:e.id},[a("td",[t._v(t._s(i+1))]),t._v(" "),a("td",[t._v(t._s(e.product_name))]),t._v(" "),a("td",[t._v("1")]),t._v(" "),a("td",[t._v("¥"+t._s(e.price.toFixed(2)))]),t._v(" "),a("td",[t._v(t._s(t._f("OrderGoodOutStatus")(e.is_out)))]),t._v(" "),2==t.pageType?[a("td",[t._v(t._s(t.order.refund_status))]),t._v(" "),a("td",[a("info-confirm",{attrs:{data:e,title:"确定要进行退款吗",text:"退款"},on:{confirm:t.refund}})],1)]:t._e()],2)}),t._v(" "),1==t.pageType?a("tr",[a("td",{attrs:{colspan:"4"}}),t._v(" "),a("td",[t._v("合计：¥"+t._s(t.order.total_amount))])]):t._e()],2)])]),t._v(" "),t._m(2)])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ibox-title"},[e("h5",[this._v("订单管理")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")]),e("span",{staticClass:"sr-only"},[this._v("Close")])]),this._v(" "),e("h4",{staticClass:"modal-title"},[this._v("订单详情")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-footer"},[e("b",{staticClass:"btn btn-white",attrs:{"data-dismiss":"modal"}},[this._v("关闭")])])}]};var o=a("VU/8")(i,s,!1,function(t){a("X2M7")},"data-v-061559e6",null);e.default=o.exports},X2M7:function(t,e){}});