webpackJsonp([5],{"ACB+":function(s,t){},VE5e:function(s,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=a("9+VK"),o={name:"UserDetails",data:function(){return{id:this.$route.params.id,roles:[],form:{},canShow:!1,canEditRole:!1,isManager:!1,isAdmin:!1}},methods:{submit:function(){var s=this,t=this.form;if(this.canShow){if(!this.form.new_password||!this.form.new_password2)return void toastr.warning("请输入密码");if(this.form.new_password!=this.form.new_password2)return void toastr.warning("密码不一致");this.form.old_password&&(t.old_password=this.form.old_password),t.new_password=this.form.new_password}this.$Service.User.edit(this.id,t).then(function(t){200==t.status?(toastr.success("保存成功"),s.isManager&&setTimeout(function(){return s.cancel()},1e3)):toastr.error(t.msg)})},restart:function(){this.canShow=!0},cancelRestart:function(){this.canShow=!1},cancel:function(){this.$router.push("/admin/user")}},created:function(){var s=this;this.roles=[],this.$Service.User.details(this.id).then(function(t){200==t.status&&(s.form=t.data)}),($.inArray("admin",e.a.getCache("user").permission)>-1||$.inArray("user",getCache("user").permission)>-1)&&(this.canEditRole=!0,this.isManager=!0),$.inArray("admin",e.a.getCache("user").permission)>-1&&(this.isAdmin=!0)},mounted:function(){}},r={render:function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"wrapper wrapper-content"},[a("div",{staticClass:"ibox float-e-margins"},[s._m(0),s._v(" "),a("div",{staticClass:"ibox-content"},[a("form",{staticClass:"form-horizontal",on:{submit:function(t){return t.preventDefault(),s.submit(t)}}},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-6"},[a("label",{staticClass:"col-sm-4 control-label"},[s._v("登录名")]),s._v(" "),a("div",{staticClass:"col-sm-8"},[a("input",{directives:[{name:"model",rawName:"v-model",value:s.form.username,expression:"form.username"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:s.form.username},on:{input:function(t){t.target.composing||s.$set(s.form,"username",t.target.value)}}})])])]),s._v(" "),a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-6"},[a("label",{staticClass:"col-sm-4 control-label"},[s._v("姓名")]),s._v(" "),a("div",{staticClass:"col-sm-8"},[a("input",{directives:[{name:"model",rawName:"v-model",value:s.form.name,expression:"form.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:s.form.name},on:{input:function(t){t.target.composing||s.$set(s.form,"name",t.target.value)}}})])])]),s._v(" "),a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-6"},[a("label",{staticClass:"col-sm-4 control-label"},[s._v("手机号码")]),s._v(" "),a("div",{staticClass:"col-sm-8"},[a("input",{directives:[{name:"model",rawName:"v-model",value:s.form.phone,expression:"form.phone"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:s.form.phone},on:{input:function(t){t.target.composing||s.$set(s.form,"phone",t.target.value)}}})])])]),s._v(" "),a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-6"},[a("label",{staticClass:"col-sm-4 control-label"},[s._v("角色名称")]),s._v(" "),"admin"!=s.form.username?a("div",{staticClass:"col-sm-8"},[a("select",{directives:[{name:"model",rawName:"v-model",value:s.form.r_id,expression:"form.r_id"}],staticClass:"form-control",attrs:{disabled:!s.canEditRole},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(s){return s.selected}).map(function(s){return"_value"in s?s._value:s.value});s.$set(s.form,"r_id",t.target.multiple?a:a[0])}}},s._l(s.roles,function(t){return a("option",{key:t.id,domProps:{value:t.id}},[s._v(s._s(t.name))])}))]):s._e(),s._v(" "),"admin"==s.form.username?a("div",{staticClass:"col-sm-8"},[a("input",{staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:"超级用户"}})]):s._e()])]),s._v(" "),"admin"!=s.form.username?a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-6"},[a("label",{staticClass:"col-sm-4 control-label"},[s._v("数据权限")]),s._v(" "),a("div",{staticClass:"col-sm-8"},[a("select",{directives:[{name:"model",rawName:"v-model",value:s.form.data_permission,expression:"form.data_permission"}],staticClass:"form-control",attrs:{disabled:!s.canEditRole},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(s){return s.selected}).map(function(s){return"_value"in s?s._value:s.value});s.$set(s.form,"data_permission",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"all"}},[s._v("全部")]),s._v(" "),a("option",{attrs:{value:"own"}},[s._v("自己")])])])])]):s._e(),s._v(" "),s.canShow?[a("hr"),s._v(" "),s.isAdmin&&"admin"!=this.form.username?s._e():a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-6"},[a("label",{staticClass:"col-sm-4 control-label"},[s._v("旧密码")]),s._v(" "),a("div",{staticClass:"col-sm-8"},[a("input",{directives:[{name:"model",rawName:"v-model",value:s.form.old_password,expression:"form.old_password"}],staticClass:"form-control",attrs:{type:"password"},domProps:{value:s.form.old_password},on:{input:function(t){t.target.composing||s.$set(s.form,"old_password",t.target.value)}}})])])]),s._v(" "),a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-6"},[a("label",{staticClass:"col-sm-4 control-label"},[s._v("新密码")]),s._v(" "),a("div",{staticClass:"col-sm-8"},[a("input",{directives:[{name:"model",rawName:"v-model",value:s.form.new_password,expression:"form.new_password"}],staticClass:"form-control",attrs:{type:"password"},domProps:{value:s.form.new_password},on:{input:function(t){t.target.composing||s.$set(s.form,"new_password",t.target.value)}}})])])]),s._v(" "),a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-6"},[a("label",{staticClass:"col-sm-4 control-label"},[s._v("确认密码")]),s._v(" "),a("div",{staticClass:"col-sm-8"},[a("input",{directives:[{name:"model",rawName:"v-model",value:s.form.new_password2,expression:"form.new_password2"}],staticClass:"form-control",attrs:{type:"password"},domProps:{value:s.form.new_password2},on:{input:function(t){t.target.composing||s.$set(s.form,"new_password2",t.target.value)}}})])])])]:s._e(),s._v(" "),a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-6"},[a("div",{staticClass:"text-center"},[s.isManager?a("b",{staticClass:"btn btn-white",on:{click:s.cancel}},[s._v("返回")]):s._e(),s._v(" "),s.canShow?s._e():a("b",{staticClass:"btn btn-warning",on:{click:s.restart}},[s._v("重置密码")]),s._v(" "),s.canShow?a("b",{staticClass:"btn btn-white",on:{click:s.cancelRestart}},[s._v("取消密码重置")]):s._e(),s._v(" "),a("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[s._v("保存")])])])])],2)])])])},staticRenderFns:[function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"ibox-title"},[t("h5",[this._v("用户详情")])])}]};var i=a("VU/8")(o,r,!1,function(s){a("ACB+")},"data-v-daca84a6",null);t.default=i.exports}});