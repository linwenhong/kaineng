webpackJsonp([17],{"1IyQ":function(t,s){},"EZQ+":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a={name:"User",data:function(){return{user:this.$store.getters.getUser,tableOptions:[{key:"id",title:"ID"},{key:"login_name",title:"登录名"},{key:"user_name",title:"姓名"},{key:"user_phone",title:"手机号码"},{key:"status",title:"用户状态"},{key:"ip",title:"登录ip"},{key:"last_login_time",title:"登录时间"}],items:[],total:0,page:1,pageSize:this.$Config.page_size,condition:{},form:{},validate:null,form2:{},validate2:null,editPasswordUser:{},isSubmit:!1}},methods:{getDataTables:function(){var t=this,s={page_no:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,page_size:this.pageSize,mch_id:this.user.mch_id};for(var e in this.condition)this.condition[e]&&(s[e]=this.condition[e]);this.$Service.User.get(s).then(function(s){s.err_code?toastr.error(s.err_msg,s.err_code):(t.items=s.list,t.total=s.total,t.$nextTick(function(){return t.$H5UI.iCheck()}))})},pageChange:function(t){this.getDataTables(t)},clear:function(){this.$H5UI.reset(this.validate),this.form={},this.isSubmit=!1,$("#Modal").modal("hide")},add:function(){this.clear()},checkForm:function(t){return 11!=t.user_phone.length?(toastr.info("请输入11位数的电话号码!"),!1):t.password&&(t.password==Number(t.password)||t.password.length<6)?void toastr.info("请输入6位以上的字母加数字的密码"):!t.password||!t.confirmPassword||t.password==t.confirmPassword||(toastr.info("两次输入的密码不一致!"),!1)},submit:function(){var t=this;if(!this.isSubmit&&$("#form").valid()&&this.checkForm(this.form)){this.isSubmit=!0;var s={user_name:this.form.user_name,user_phone:this.form.user_phone};this.form.password&&(s.password=this.form.password),s.role_id=0,s.user_type=2,this.form.id?(s.login_name=this.form.login_name,this.$Service.User.edit(s).then(function(s){t.isSubmit=!1,0==s.err_code?(toastr.success("修改成功"),t.getDataTables(t.page),$("#Modal").modal("hide")):toastr.error(s.err_msg,s.err_code)})):(s.login_name=this.form.login_name,s.mch_id=this.user.mch_id,this.$Service.User.add(s).then(function(s){t.isSubmit=!1,0==s.err_code?(toastr.success("新增成功"),t.getDataTables(),$("#Modal").modal("hide")):toastr.error(s.err_msg,s.err_code)}))}},edit:function(t){this.clear(),this.form={id:t.id,login_name:t.login_name,user_name:t.user_name,user_phone:t.user_phone}},del:function(t){var s=this;this.$Service.User.del({login_name:t.login_name}).then(function(t){0==t.err_code?(toastr.success("删除成功"),s.getDataTables()):toastr.error(t.err_msg,t.err_code)})},editPassword:function(t){this.form2={},this.editPasswordUser=t},submit2:function(){if(this.form2.new_password==this.form2.new_password2){var t={login_name:this.editPasswordUser.login_name,old_password:this.form2.old_password,new_password:this.form2.new_password};this.$Service.User.editPassword(t).then(function(t){0==t.err_code?(toastr.success("密码修改成功"),$("#Modal2").modal("hide")):toastr.error(t.err_msg,t.err_code)})}else toastr.info("两次输入的密码不一致!")}},created:function(){this.getDataTables()},mounted:function(){this.validate=this.$H5UI.validate("#form"),this.validate2=this.$H5UI.validate("#form2")}},o={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"wrapper wrapper-content"},[e("page-header-button",{on:{add:t.add}}),t._v(" "),e("div",{staticClass:"ibox float-e-margins"},[t._m(0),t._v(" "),e("div",{staticClass:"ibox-content"},[e("div",{staticClass:"search-page"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"control-label"},[t._v("姓名")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.condition.user_name,expression:"condition['user_name']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.condition.user_name},on:{input:function(s){s.target.composing||t.$set(t.condition,"user_name",s.target.value.trim())},blur:function(s){t.$forceUpdate()}}}),t._v(" "),e("button",{staticClass:"btn btn-primary search",attrs:{type:"button"},on:{click:function(s){t.getDataTables()}}},[t._v("查询")])])]),t._v(" "),e("table",{staticClass:"table table-bordered text-center"},[e("thead",[e("tr",[t._l(t.tableOptions,function(s){return e("th",[t._v(t._s(s.title))])}),t._v(" "),e("th",[t._v("操作")])],2)]),t._v(" "),e("tbody",t._l(t.items,function(s,a){return e("tr",{key:s.id},[e("td",[t._v(t._s(s.id))]),t._v(" "),e("td",[t._v(t._s(s.login_name))]),t._v(" "),e("td",[t._v(t._s(s.user_name))]),t._v(" "),e("td",[t._v(t._s(s.user_phone))]),t._v(" "),e("td",[t._v(t._s(s.status))]),t._v(" "),e("td",[t._v(t._s(s.ip))]),t._v(" "),e("td",[t._v(t._s(s.last_login_time))]),t._v(" "),e("td",[e("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button","data-toggle":"modal","data-target":"#Modal"},on:{click:function(e){t.edit(s)}}},[t._v("编辑")]),t._v(" "),1==t.user.user_type?e("button",{staticClass:"btn btn-sm btn-warning",attrs:{type:"button","data-toggle":"modal","data-target":"#Modal2"},on:{click:function(e){t.editPassword(s)}}},[t._v("更改密码")]):t._e(),t._v(" "),e("info-confirm",{attrs:{data:s},on:{confirm:t.del}})],1)])}))]),t._v(" "),e("vue-pagination",{attrs:{"current-page":t.page,total:t.total,"page-size":t.pageSize,theme:"gray"},on:{"current-change":t.pageChange}})],1)]),t._v(" "),e("div",{staticClass:"modal inmodal fade",attrs:{id:"Modal",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-md"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[t._m(1),t._v(" "),e("h4",{staticClass:"modal-title"},[t._v(t._s(t.form.id?"修改用户信息":"新增用户"))])]),t._v(" "),e("form",{staticClass:"form-horizontal",attrs:{id:"form"},on:{submit:function(s){return s.preventDefault(),t.submit(s)}}},[e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"col-sm-3 control-label"},[t._v("登录名")]),t._v(" "),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.form.login_name,expression:"form.login_name",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",required:"","aria-required":"true",oninput:"NonSpecialSymbolsFormat(this)",name:"login_name",disabled:t.form.id},domProps:{value:t.form.login_name},on:{input:function(s){s.target.composing||t.$set(t.form,"login_name",s.target.value.trim())},blur:function(s){t.$forceUpdate()}}})])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"col-sm-3 control-label"},[t._v("姓名")]),t._v(" "),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.form.user_name,expression:"form.user_name",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",required:"","aria-required":"true",name:"user_name"},domProps:{value:t.form.user_name},on:{input:function(s){s.target.composing||t.$set(t.form,"user_name",s.target.value.trim())},blur:function(s){t.$forceUpdate()}}})])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"col-sm-3 control-label"},[t._v("手机号码")]),t._v(" "),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user_phone,expression:"form.user_phone"}],staticClass:"form-control",attrs:{type:"text",required:"","aria-required":"true",maxlength:"11",oninput:"numberFormat(this)",name:"user_phone"},domProps:{value:t.form.user_phone},on:{input:function(s){s.target.composing||t.$set(t.form,"user_phone",s.target.value)}}})])]),t._v(" "),t.form.id?t._e():[e("div",{staticClass:"form-group"},[e("label",{staticClass:"col-sm-3 control-label"},[t._v("初始密码")]),t._v(" "),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"form-control",attrs:{type:"password",required:"","aria-required":"true",oninput:"NonSpecialSymbolsFormat(this)",name:"password"},domProps:{value:t.form.password},on:{input:function(s){s.target.composing||t.$set(t.form,"password",s.target.value)}}})])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"col-sm-3 control-label"},[t._v("确认密码")]),t._v(" "),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.confirmPassword,expression:"form.confirmPassword"}],staticClass:"form-control",attrs:{type:"password",required:"","aria-required":"true",oninput:"NonSpecialSymbolsFormat(this)",name:"confirmPassword"},domProps:{value:t.form.confirmPassword},on:{input:function(s){s.target.composing||t.$set(t.form,"confirmPassword",s.target.value)}}})])])]],2)]),t._v(" "),t._m(2)])])])]),t._v(" "),e("div",{staticClass:"modal inmodal fade",attrs:{id:"Modal2",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-md"},[e("div",{staticClass:"modal-content"},[t._m(3),t._v(" "),e("form",{staticClass:"form-horizontal",attrs:{id:"form2"},on:{submit:function(s){return s.preventDefault(),t.submit2(s)}}},[e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"col-sm-3 control-label"},[t._v("原密码")]),t._v(" "),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form2.old_password,expression:"form2.old_password"}],staticClass:"form-control",attrs:{type:"password",required:"","aria-required":"true",oninput:"NonSpecialSymbolsFormat(this)",name:"old_password"},domProps:{value:t.form2.old_password},on:{input:function(s){s.target.composing||t.$set(t.form2,"old_password",s.target.value)}}})])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"col-sm-3 control-label"},[t._v("新密码")]),t._v(" "),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form2.new_password,expression:"form2.new_password"}],staticClass:"form-control",attrs:{type:"password",required:"","aria-required":"true",oninput:"NonSpecialSymbolsFormat(this)",name:"new_password"},domProps:{value:t.form2.new_password},on:{input:function(s){s.target.composing||t.$set(t.form2,"new_password",s.target.value)}}})])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"col-sm-3 control-label"},[t._v("确认密码")]),t._v(" "),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form2.new_password2,expression:"form2.new_password2"}],staticClass:"form-control",attrs:{type:"password",required:"","aria-required":"true",oninput:"NonSpecialSymbolsFormat(this)",name:"new_password2"},domProps:{value:t.form2.new_password2},on:{input:function(s){s.target.composing||t.$set(t.form2,"new_password2",s.target.value)}}})])])])]),t._v(" "),t._m(4)])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"ibox-title"},[s("h5",[this._v("用户管理")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[s("span",{attrs:{"aria-hidden":"true"}},[this._v("×")]),s("span",{staticClass:"sr-only"},[this._v("Close")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"modal-footer"},[s("b",{staticClass:"btn btn-white",attrs:{"data-dismiss":"modal"}},[this._v("关闭")]),this._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[this._v("提交")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"modal-header"},[s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[s("span",{attrs:{"aria-hidden":"true"}},[this._v("×")]),s("span",{staticClass:"sr-only"},[this._v("Close")])]),this._v(" "),s("h4",{staticClass:"modal-title"},[this._v("修改密码")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"modal-footer"},[s("b",{staticClass:"btn btn-white",attrs:{"data-dismiss":"modal"}},[this._v("关闭")]),this._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[this._v("提交")])])}]};var r=e("VU/8")(a,o,!1,function(t){e("1IyQ")},"data-v-47aca124",null);s.default=r.exports}});