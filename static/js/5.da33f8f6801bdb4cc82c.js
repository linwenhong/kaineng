webpackJsonp([5],{Hsze:function(t,e){},mK2Z:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"Good",data:function(){return{user:this.$store.getters.getUser,tableOptions:[{key:"id",title:"ID"},{key:"code",title:"商品编码"},{key:"product_name",title:"商品名称"},{key:"category_name",title:"商品类型"},{key:"spec",title:"商品规格"},{key:"remark",title:"备注"}],items:[],GoodType:[],total:0,page:1,pageSize:this.$Config.page_size,condition:{type_id:""},form:{},detailsImgUrl:"",validate:null,value:null,TreeSelectOption:[],isSubmit:!1}},methods:{getDataTables:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i={mch_id:this.user.mch_id,page_no:e,page_size:this.pageSize};for(var a in this.condition)this.condition[a]&&(i[a]=this.condition[a]);i.category_id=i.category_id||0,this.$Service.Good.get(i).then(function(e){e.err_code?toastr.error(e.err_msg,e.err_code):(t.items=e.list,t.total=e.total,t.$nextTick(function(){return t.$H5UI.iCheck()}))})},pageChange:function(t){this.getDataTables(t)},clear:function(){this.$H5UI.reset(this.validate),this.form={},this.isSubmit=!1,$("#file").val(""),$("#img").attr("src",""),$("#Modal").modal("hide")},add:function(){this.clear()},checkForm:function(t){return!!$("#img").attr("src")||(toastr.info("请选择商品图片!"),!1)},submit:function(){var t=this;if(!this.isSubmit&&$("#form").valid()&&this.checkForm(this.form)){this.isSubmit=!0;var e={mch_id:this.user.mch_id,category_id:this.form.category_id,code:this.form.code,product_name:this.form.product_name,remark:this.form.remark,spec:this.form.spec};(!this.form.id||this.form.id&&$("#img").attr("src")!=this.detailsImgUrl)&&(e.img=$("#img").attr("src").split("base64,")[1],e.img_format=this.form.img_format),this.form.id?(e.id=this.form.id,e.mch_id=this.valuationGood.mch_id,this.$Service.Good.edit(e).then(function(e){t.isSubmit=!1,0==e.err_code?(toastr.success("修改成功"),t.getDataTables(t.page),$("#Modal").modal("hide")):toastr.error(e.err_msg,e.err_code)})):(e.mch_id=this.user.mch_id,this.$Service.Good.add(e).then(function(e){t.isSubmit=!1,0==e.err_code?(toastr.success("新增成功"),t.getDataTables(),$("#Modal").modal("hide")):toastr.error(e.err_msg,e.err_code)}))}},edit:function(t){this.clear(),this.form={id:t.id,mch_id:t.mch_id,category_id:t.category_id,code:t.code,img_path:t.img_path,img_format:t.img_format,product_name:t.product_name,remark:t.remark,spec:t.spec},this.detailsImgUrl=this.$Config.img_url+t.img_path,$("#img").attr("src",this.detailsImgUrl)},del:function(t){var e=this;this.$Service.Good.del({id:t.id,mch_id:t.mch_id}).then(function(t){0==t.err_code?(toastr.success("删除成功"),e.getDataTables()):toastr.error(t.err_msg,t.err_code)})},getGoodType:function(){var t=this,e={mch_id:this.user.mch_id,page_no:1,page_size:1e4};this.$Service.GoodType.get(e).then(function(e){e.err_code?toastr.error(e.err_msg,e.err_code):(t.GoodType=e.list,t.TreeSelectOption=t.$Method.getTreeSelectOption(e.list,!0))})},preview:function(t){var e=t.target.value;if(e){var i=e.split(".");this.form.img_format=i[i.length-1],this.$H5UI.setImgBase(t,"#img")}},valuation:function(t){this.$router.push("/merchant/good-price?type_id="+t.category_id+"&good_id="+t.id)}},created:function(){this.getGoodType(),this.getDataTables()},mounted:function(){this.validate=this.$H5UI.validate("#form")}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapper wrapper-content"},[i("page-header-button",{on:{add:t.add}}),t._v(" "),i("div",{staticClass:"ibox float-e-margins"},[t._m(0),t._v(" "),i("div",{staticClass:"ibox-content"},[i("div",{staticClass:"search-page"},[i("div",{staticClass:"form-group"},[i("label",{staticClass:"control-label"},[t._v("商品分类")]),t._v(" "),i("div",{staticClass:"searchOption"},[i("treeselect",{attrs:{multiple:!1,options:t.TreeSelectOption},model:{value:t.condition.category_id,callback:function(e){t.$set(t.condition,"category_id",e)},expression:"condition.category_id"}})],1),t._v(" "),i("button",{staticClass:"btn btn-primary search",attrs:{type:"button"},on:{click:function(e){t.getDataTables()}}},[t._v("查询")])])]),t._v(" "),i("table",{staticClass:"table table-bordered text-center"},[i("thead",[i("tr",[t._l(t.tableOptions,function(e){return i("th",[t._v(t._s(e.title))])}),t._v(" "),i("th",[t._v("操作")])],2)]),t._v(" "),i("tbody",t._l(t.items,function(e,a){return i("tr",{key:e.id},[i("td",[t._v(t._s(e.id))]),t._v(" "),i("td",[t._v(t._s(e.code))]),t._v(" "),i("td",[t._v(t._s(e.product_name))]),t._v(" "),i("td",[t._v(t._s(e.category_name))]),t._v(" "),i("td",[t._v(t._s(e.spec))]),t._v(" "),i("td",[t._v(t._s(e.remark))]),t._v(" "),i("td",[i("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button","data-toggle":"modal","data-target":"#Modal"},on:{click:function(i){t.edit(e)}}},[t._v("编辑")]),t._v(" "),i("button",{staticClass:"btn btn-sm btn-warning",attrs:{type:"button"},on:{click:function(i){t.valuation(e)}}},[t._v("定价")]),t._v(" "),i("info-confirm",{attrs:{data:e},on:{confirm:t.del}})],1)])}))]),t._v(" "),i("vue-pagination",{attrs:{"current-page":t.page,total:t.total,"page-size":t.pageSize,theme:"gray"},on:{"current-change":t.pageChange}})],1)]),t._v(" "),i("div",{staticClass:"modal inmodal fade",attrs:{id:"Modal",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[i("div",{staticClass:"modal-dialog modal-md"},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-header"},[t._m(1),t._v(" "),i("h4",{staticClass:"modal-title"},[t._v(t._s(t.form.id?"修改商品信息":"新增商品"))])]),t._v(" "),i("form",{staticClass:"form-horizontal",attrs:{id:"form"},on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row"},[i("div",{staticClass:"form-group"},[i("label",{staticClass:"col-sm-3 control-label"},[t._v("商品名称")]),t._v(" "),i("div",{staticClass:"col-sm-8"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.form.product_name,expression:"form.product_name",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",required:"","aria-required":"true",name:"product_name"},domProps:{value:t.form.product_name},on:{input:function(e){e.target.composing||t.$set(t.form,"product_name",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])]),t._v(" "),i("div",{staticClass:"form-group"},[i("label",{staticClass:"col-sm-3 control-label"},[t._v("商品名称")]),t._v(" "),i("div",{staticClass:"col-sm-8"},[i("button",{staticClass:"btn btn-sm btn-primary btn_file",attrs:{type:"button"}},[i("i",{staticClass:"fa fa-upload"}),t._v("  \n                    "),i("span",{staticClass:"bold"},[t._v("选择图片")]),t._v(" "),i("input",{staticClass:"file",attrs:{id:"file",type:"file",accept:"image/*"},on:{change:function(e){t.preview(e)}}})]),t._v(" "),t._m(2)])]),t._v(" "),i("div",{staticClass:"form-group"},[i("label",{staticClass:"col-sm-3 control-label"},[t._v("商品编码")]),t._v(" "),i("div",{staticClass:"col-sm-8"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.form.code,expression:"form.code",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",name:"code"},domProps:{value:t.form.code},on:{input:function(e){e.target.composing||t.$set(t.form,"code",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])]),t._v(" "),i("div",{staticClass:"form-group"},[i("label",{staticClass:"col-sm-3 control-label"},[t._v("商品类型")]),t._v(" "),i("div",{staticClass:"col-sm-8"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.form.category_id,expression:"form['category_id']"}],staticClass:"form-control",attrs:{required:"","aria-required":"true",name:"category_id"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.form,"category_id",e.target.multiple?i:i[0])}}},t._l(t.GoodType,function(e){return i("option",{domProps:{value:e.id}},[t._v(t._s(e.name))])}))])]),t._v(" "),i("div",{staticClass:"form-group"},[i("label",{staticClass:"col-sm-3 control-label"},[t._v("商品规格")]),t._v(" "),i("div",{staticClass:"col-sm-8"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.form.spec,expression:"form.spec",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",name:"spec"},domProps:{value:t.form.spec},on:{input:function(e){e.target.composing||t.$set(t.form,"spec",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])]),t._v(" "),i("div",{staticClass:"form-group"},[i("label",{staticClass:"col-sm-3 control-label"},[t._v("备注")]),t._v(" "),i("div",{staticClass:"col-sm-8"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.form.remark,expression:"form.remark",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",name:"remark"},domProps:{value:t.form.remark},on:{input:function(e){e.target.composing||t.$set(t.form,"remark",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])])])]),t._v(" "),t._m(3)])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ibox-title"},[e("h5",[this._v("商品管理")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")]),e("span",{staticClass:"sr-only"},[this._v("Close")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"view-img"},[e("img",{attrs:{id:"img"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-footer"},[e("b",{staticClass:"btn btn-white",attrs:{"data-dismiss":"modal"}},[this._v("关闭")]),this._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[this._v("提交")])])}]};var r=i("VU/8")(a,s,!1,function(t){i("Hsze")},"data-v-c68f9ed8",null);e.default=r.exports}});