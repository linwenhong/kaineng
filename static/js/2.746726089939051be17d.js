webpackJsonp([2],{"+tPU":function(t,e,r){r("xGkn");for(var n=r("7KvD"),i=r("hJx8"),s=r("/bQp"),o=r("dSzd")("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<a.length;c++){var u=a[c],l=n[u],d=l&&l.prototype;d&&!d[o]&&i(d,o,u),s[u]=s.Array}},"/bQp":function(t,e){t.exports={}},"3Eo+":function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},"3fs2":function(t,e,r){var n=r("RY/4"),i=r("dSzd")("iterator"),s=r("/bQp");t.exports=r("FeBl").getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||s[n(t)]}},"4mcu":function(t,e){t.exports=function(){}},"52gC":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},"880/":function(t,e,r){t.exports=r("hJx8")},"94VQ":function(t,e,r){"use strict";var n=r("Yobk"),i=r("X8DO"),s=r("e6n0"),o={};r("hJx8")(o,r("dSzd")("iterator"),function(){return this}),t.exports=function(t,e,r){t.prototype=n(o,{next:i(1,r)}),s(t,e+" Iterator")}},BO1k:function(t,e,r){t.exports={default:r("fxRn"),__esModule:!0}},EGZi:function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},Ibhu:function(t,e,r){var n=r("D2L2"),i=r("TcQ7"),s=r("vFc/")(!1),o=r("ax3d")("IE_PROTO");t.exports=function(t,e){var r,a=i(t),c=0,u=[];for(r in a)r!=o&&n(a,r)&&u.push(r);for(;e.length>c;)n(a,r=e[c++])&&(~s(u,r)||u.push(r));return u}},MU5D:function(t,e,r){var n=r("R9M2");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},O4g8:function(t,e){t.exports=!0},PzxK:function(t,e,r){var n=r("D2L2"),i=r("sB3e"),s=r("ax3d")("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},QRG4:function(t,e,r){var n=r("UuGF"),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},R9M2:function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},RPLV:function(t,e,r){var n=r("7KvD").document;t.exports=n&&n.documentElement},"RY/4":function(t,e,r){var n=r("R9M2"),i=r("dSzd")("toStringTag"),s="Arguments"==n(function(){return arguments}());t.exports=function(t){var e,r,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?r:s?n(e):"Object"==(o=n(e))&&"function"==typeof e.callee?"Arguments":o}},TcQ7:function(t,e,r){var n=r("MU5D"),i=r("52gC");t.exports=function(t){return n(i(t))}},UuGF:function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},Yobk:function(t,e,r){var n=r("77Pl"),i=r("qio6"),s=r("xnc9"),o=r("ax3d")("IE_PROTO"),a=function(){},c=function(){var t,e=r("ON07")("iframe"),n=s.length;for(e.style.display="none",r("RPLV").appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;n--;)delete c.prototype[s[n]];return c()};t.exports=Object.create||function(t,e){var r;return null!==t?(a.prototype=n(t),r=new a,a.prototype=null,r[o]=t):r=c(),void 0===e?r:i(r,e)}},ax3d:function(t,e,r){var n=r("e8AB")("keys"),i=r("3Eo+");t.exports=function(t){return n[t]||(n[t]=i(t))}},b1Un:function(t,e){},dSzd:function(t,e,r){var n=r("e8AB")("wks"),i=r("3Eo+"),s=r("7KvD").Symbol,o="function"==typeof s;(t.exports=function(t){return n[t]||(n[t]=o&&s[t]||(o?s:i)("Symbol."+t))}).store=n},e6n0:function(t,e,r){var n=r("evD5").f,i=r("D2L2"),s=r("dSzd")("toStringTag");t.exports=function(t,e,r){t&&!i(t=r?t:t.prototype,s)&&n(t,s,{configurable:!0,value:e})}},e8AB:function(t,e,r){var n=r("7KvD"),i=n["__core-js_shared__"]||(n["__core-js_shared__"]={});t.exports=function(t){return i[t]||(i[t]={})}},fkB2:function(t,e,r){var n=r("UuGF"),i=Math.max,s=Math.min;t.exports=function(t,e){return(t=n(t))<0?i(t+e,0):s(t,e)}},fxRn:function(t,e,r){r("+tPU"),r("zQR9"),t.exports=r("g8Ux")},g8Ux:function(t,e,r){var n=r("77Pl"),i=r("3fs2");t.exports=r("FeBl").getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}},h65t:function(t,e,r){var n=r("UuGF"),i=r("52gC");t.exports=function(t){return function(e,r){var s,o,a=String(i(e)),c=n(r),u=a.length;return c<0||c>=u?t?"":void 0:(s=a.charCodeAt(c))<55296||s>56319||c+1===u||(o=a.charCodeAt(c+1))<56320||o>57343?t?a.charAt(c):s:t?a.slice(c,c+2):o-56320+(s-55296<<10)+65536}}},lktj:function(t,e,r){var n=r("Ibhu"),i=r("xnc9");t.exports=Object.keys||function(t){return n(t,i)}},qio6:function(t,e,r){var n=r("evD5"),i=r("77Pl"),s=r("lktj");t.exports=r("+E39")?Object.defineProperties:function(t,e){i(t);for(var r,o=s(e),a=o.length,c=0;a>c;)n.f(t,r=o[c++],e[r]);return t}},sB3e:function(t,e,r){var n=r("52gC");t.exports=function(t){return Object(n(t))}},tdCf:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("BO1k"),i=r.n(n),s={name:"ReplenishOrder",data:function(){return{user:this.$store.getters.getUser,deviceId:this.$route.query.device_id,tableOptions:[{key:"trade_no",title:"编号"},{key:"mch_name",title:"商户"},{key:"device_id",title:"设备sn"},{key:"device_name",title:"设备名"},{key:"order_status",title:"状态"},{key:"create_at",title:"创建时间"}],items:[],DevicePassageways:[],Passageways:[],total:0,page:1,pageSize:this.$Config.page_size,condition:{order_status:3},selectOrder:{},validate:null,isSubmit:!1}},methods:{getDataTables:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r={mch_id:this.user.mch_id,device_id:this.deviceId,page_no:e,page_size:this.pageSize};for(var n in this.condition)this.condition[n]&&(r[n]=this.condition[n]);this.$Service.ReplenishOrder.get(r).then(function(e){e.err_code?toastr.error(e.err_msg,e.err_code):(t.items=e.list,t.total=e.total,t.$nextTick(function(){return t.$H5UI.iCheck()}))})},pageChange:function(t){this.getDataTables(t)},clear:function(){this.$H5UI.reset(this.validate),this.form={},this.isSubmit=!1,$("#file").val(""),$("#img").attr("src",""),$("#Modal").modal("hide")},add:function(){this.clear()},checkForm:function(t){return!0},submit:function(){var t=this;if(!this.isSubmit&&$("#form").valid()&&this.checkForm(this.form)){this.isSubmit=!0;var e={mch_id:this.selectOrder.mch_id,trade_no:this.selectOrder.trade_no,list:[]},r={mch_id:this.selectOrder.mch_id,trade_no:this.selectOrder.trade_no,list:[]};this.Passageways.map(function(t){var n={channel_no:t.channel_no,product_name:t.product_name,spec:t.spec,price:t.price,residue:t.residue,require_sum:t.require_sum||0};t.id?(n.id=t.id,e.list.push(n)):t.require_sum>0&&r.list.push(n)}),e.list.length>0&&this.$Service.ReplenishOrder.edit(e).then(function(e){t.isSubmit=!1,0==e.err_code?(toastr.success("修改成功"),t.getDataTables(t.page),$("#Modal").modal("hide")):toastr.error(e.err_msg,e.err_code)}),r.list.length>0&&this.$Service.ReplenishOrder.detailsAdd(r).then(function(t){0==t.err_code||toastr.error(t.err_msg,t.err_code)})}},edit:function(t){var e=this;this.clear(),this.selectOrder=t,this.Passageways=[],this.$Service.ReplenishOrder.details({mch_id:this.user.mch_id,trade_no:t.trade_no,page_no:1,page_size:1e4}).then(function(t){0==t.err_code?e.setPassageways(t.list||[]):toastr.error(t.err_msg,t.err_code)})},cancel:function(t){var e=this;this.$Service.ReplenishOrder.cancel({mch_id:this.user.mch_id,trade_no:t.trade_no}).then(function(t){0==t.err_code?(toastr.success("取消成功"),e.getDataTables()):toastr.error(t.err_msg,t.err_code)})},getDevicePassageways:function(){var t=this;this.$Service.GoodUpperShelf.get({mch_id:this.user.mch_id,device_id:this.deviceId,page_no:1,page_size:1e4}).then(function(e){e.err_code?toastr.error(e.err_msg,e.err_code):t.DevicePassageways=e.list})},setPassageways:function(t){this.Passageways=this.DevicePassageways.map(function(e){var r={channel_no:e.channel_no,product_name:e.product_name,spec:e.spec,price:e.product_price,residue:e.product_sum,require_sum:0},n=!0,s=!1,o=void 0;try{for(var a,c=i()(t);!(n=(a=c.next()).done);n=!0){var u=a.value;if(u.channel_no==e.channel_no){r.id=u.id,r.require_sum=u.require_sum;break}}}catch(t){s=!0,o=t}finally{try{!n&&c.return&&c.return()}finally{if(s)throw o}}return r})}},created:function(){this.getDevicePassageways(),this.getDataTables()},mounted:function(){this.validate=this.$H5UI.validate("#form")}},o={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"wrapper wrapper-content"},[r("page-header-button",{on:{add:t.add}}),t._v(" "),r("div",{staticClass:"ibox float-e-margins"},[t._m(0),t._v(" "),r("div",{staticClass:"ibox-content"},[r("div",{staticClass:"search-page"},[r("div",{staticClass:"form-group"},[r("label",{staticClass:"control-label"},[t._v("商品分类")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.condition.order_status,expression:"condition['order_status']"}],staticClass:"form-control",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.condition,"order_status",e.target.multiple?r:r[0])}}},[r("option",{attrs:{value:"3"}},[t._v("全部")]),t._v(" "),r("option",{attrs:{value:"0"}},[t._v("未完成")]),t._v(" "),r("option",{attrs:{value:"1"}},[t._v("已完成")]),t._v(" "),r("option",{attrs:{value:"2"}},[t._v("已取消")])]),t._v(" "),r("button",{staticClass:"btn btn-primary search",attrs:{type:"button"},on:{click:function(e){t.getDataTables()}}},[t._v("查询")])])]),t._v(" "),r("table",{staticClass:"table table-bordered text-center"},[r("thead",[r("tr",[t._l(t.tableOptions,function(e){return r("th",[t._v(t._s(e.title))])}),t._v(" "),r("th",[t._v("操作")])],2)]),t._v(" "),r("tbody",t._l(t.items,function(e,n){return r("tr",{key:e.id},[r("td",[t._v(t._s(e.trade_no))]),t._v(" "),r("td",[t._v(t._s(e.mch_name))]),t._v(" "),r("td",[t._v(t._s(e.device_id))]),t._v(" "),r("td",[t._v(t._s(e.device_name))]),t._v(" "),r("td",[t._v(t._s(t._f("ReplenishOrderStatus")(e.order_status)))]),t._v(" "),r("td",[t._v(t._s(e.create_at))]),t._v(" "),r("td",[r("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button","data-toggle":"modal","data-target":"#Modal"},on:{click:function(r){t.edit(e)}}},[t._v("编辑")]),t._v(" "),0==e.order_status?[r("info-confirm",{attrs:{data:e,text:"取消",title:"确定要取消订单吗？"},on:{confirm:t.cancel}})]:t._e()],2)])}))]),t._v(" "),r("vue-pagination",{attrs:{"current-page":t.page,total:t.total,"page-size":t.pageSize,theme:"gray"},on:{"current-change":t.pageChange}})],1)]),t._v(" "),r("div",{staticClass:"modal inmodal fade",attrs:{id:"Modal",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog modal-md"},[r("div",{staticClass:"modal-content"},[t._m(1),t._v(" "),r("form",{staticClass:"form-horizontal",attrs:{id:"form"},on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[r("div",{staticClass:"modal-body"},[r("table",{staticClass:"table table-bordered text-center"},[t._m(2),t._v(" "),r("tbody",t._l(t.Passageways,function(e,n){return r("tr",{key:e.id},[r("td",[t._v(t._s(e.channel_no))]),t._v(" "),r("td",[t._v(t._s(e.product_name))]),t._v(" "),r("td",[t._v(t._s(e.spec))]),t._v(" "),r("td",[t._v(t._s(e.residue))]),t._v(" "),r("td",{staticStyle:{width:"100px"}},[r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.require_sum,expression:"passageway.require_sum",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"text",maxlength:"4",oninput:"numberFormat(this)",name:"require_sum"},domProps:{value:e.require_sum},on:{input:function(r){r.target.composing||t.$set(e,"require_sum",t._n(r.target.value))},blur:function(e){t.$forceUpdate()}}})])])}))])]),t._v(" "),t._m(3)])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ibox-title"},[e("h5",[this._v("设备补货订单管理")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")]),e("span",{staticClass:"sr-only"},[this._v("Close")])]),this._v(" "),e("h4",{staticClass:"modal-title"},[this._v("补货详情")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",[r("th",[t._v("货道号")]),t._v(" "),r("th",[t._v("商品")]),t._v(" "),r("th",[t._v("规格")]),t._v(" "),r("th",[t._v("原库存")]),t._v(" "),r("th",[t._v("要求补货数量")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-footer"},[e("b",{staticClass:"btn btn-white",attrs:{"data-dismiss":"modal"}},[this._v("关闭")]),this._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[this._v("提交")])])}]};var a=r("VU/8")(s,o,!1,function(t){r("b1Un")},"data-v-5ec8915e",null);e.default=a.exports},"vFc/":function(t,e,r){var n=r("TcQ7"),i=r("QRG4"),s=r("fkB2");t.exports=function(t){return function(e,r,o){var a,c=n(e),u=i(c.length),l=s(o,u);if(t&&r!=r){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((t||l in c)&&c[l]===r)return t||l||0;return!t&&-1}}},"vIB/":function(t,e,r){"use strict";var n=r("O4g8"),i=r("kM2E"),s=r("880/"),o=r("hJx8"),a=r("/bQp"),c=r("94VQ"),u=r("e6n0"),l=r("PzxK"),d=r("dSzd")("iterator"),v=!([].keys&&"next"in[].keys()),_=function(){return this};t.exports=function(t,e,r,f,h,p,m){c(r,e,f);var g,b,y,x=function(t){if(!v&&t in k)return k[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},S=e+" Iterator",O="values"==h,C=!1,k=t.prototype,P=k[d]||k["@@iterator"]||h&&k[h],L=P||x(h),w=h?O?x("entries"):L:void 0,T="Array"==e&&k.entries||P;if(T&&(y=l(T.call(new t)))!==Object.prototype&&y.next&&(u(y,S,!0),n||"function"==typeof y[d]||o(y,d,_)),O&&P&&"values"!==P.name&&(C=!0,L=function(){return P.call(this)}),n&&!m||!v&&!C&&k[d]||o(k,d,L),a[e]=L,a[S]=_,h)if(g={values:O?L:x("values"),keys:p?L:x("keys"),entries:w},m)for(b in g)b in k||s(k,b,g[b]);else i(i.P+i.F*(v||C),e,g);return g}},xGkn:function(t,e,r){"use strict";var n=r("4mcu"),i=r("EGZi"),s=r("/bQp"),o=r("TcQ7");t.exports=r("vIB/")(Array,"Array",function(t,e){this._t=o(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])},"values"),s.Arguments=s.Array,n("keys"),n("values"),n("entries")},xnc9:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},zQR9:function(t,e,r){"use strict";var n=r("h65t")(!0);r("vIB/")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})})}});